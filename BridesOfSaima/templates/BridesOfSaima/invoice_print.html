<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoice {{ invoice.invoice_number }} - Brides of Saima</title>
    {% load static %}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;600;700&family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Playfair Display', serif;
            color: #333;
            line-height: 1.6;
            background-image: url('{% static "BridesOfSaima/images/bride2.jpg" %}');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-repeat: no-repeat;
            position: relative;
        }
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            z-index: -1;
        }
        .company-name {
            font-family: 'Dancing Script', cursive;
            color: #d4af37;
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }
        .invoice-header {
            border-bottom: 3px solid #d4af37;
            padding-bottom: 2rem;
            margin-bottom: 2rem;
        }
        .invoice-number {
            font-size: 2rem;
            font-weight: bold;
            color: #333;
        }
        .invoice-number-value {
            font-size: 2.5rem !important;
            font-weight: bold !important;
            color: #d4af37 !important;
            margin-top: 0.5rem;
        }
        .logo-placeholder {
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }
        .company-logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 1rem;
        }
        .invoice-number-section {
            text-align: right;
        }
        .table th {
            background-color: #f8f9fa;
            border-top: 2px solid #d4af37;
        }
        .total-row {
            background-color: #d4af37;
            color: white;
            font-weight: bold;
        }
        @media print {
            .no-print { display: none !important; }
            body { 
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                font-size: 14px;
                margin: 0;
                padding: 0;
                background-image: url('{% static "BridesOfSaima/images/bride2.jpg" %}') !important;
                background-size: cover !important;
                background-position: center !important;
                background-repeat: no-repeat !important;
            }
            body::before {
                background: rgba(255, 255, 255, 0.98) !important;
            }
            .container {
                max-width: 100%;
                padding: 10px;
                margin: 0;
            }
            .invoice-header {
                padding-bottom: 1rem;
                margin-bottom: 1rem;
                border-bottom: 3px solid #d4af37 !important;
            }
            .company-name {
                font-size: 2.5rem !important;
                color: #d4af37 !important;
                margin-bottom: 0.3rem !important;
            }
            .invoice-number {
                font-size: 1.8rem !important;
                color: #333 !important;
                margin-bottom: 0.3rem !important;
            }
            .invoice-number-value {
                font-size: 2.2rem !important;
                font-weight: bold !important;
                color: #d4af37 !important;
                margin-top: 0.5rem !important;
            }
            .logo-placeholder {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                background: linear-gradient(45deg, #d4af37, #f4e4a6) !important;
                width: 50px !important;
                height: 50px !important;
                margin-bottom: 10px !important;
            }
            .company-logo-section {
                display: flex !important;
                align-items: center !important;
                gap: 10px !important;
                margin-bottom: 0.8rem !important;
            }
            .invoice-number-section {
                text-align: right !important;
            }
            .company-details {
                font-size: 0.9rem !important;
                line-height: 1.4 !important;
            }
            .badge {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                font-size: 0.9rem !important;
                padding: 0.4rem 0.8rem !important;
            }
            .table {
                font-size: 13px;
                margin-bottom: 0.5rem;
            }
            .totals-section {
                page-break-inside: avoid;
                break-inside: avoid;
                margin-top: 0.5rem;
            }
            .terms-conditions {
                page-break-inside: avoid;
                break-inside: avoid;
                margin-top: 0.5rem;
            }
            h5, h6 {
                font-size: 16px;
                margin-bottom: 0.5rem;
            }
            /* Force side-by-side layout */
            .row {
                display: flex !important;
                flex-wrap: nowrap !important;
                margin: 0 -0.5rem;
            }
            .col-6 {
                flex: 0 0 50% !important;
                max-width: 50% !important;
                padding: 0 0.5rem;
                width: 50% !important;
            }
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <!-- Print Button -->
        <div class="no-print mb-3">
            <button onclick="window.print()" class="btn btn-primary">
                <i class="fas fa-print"></i> Print Invoice
            </button>
            <button onclick="window.close()" class="btn btn-secondary ms-2">
                Close
            </button>
        </div>

        <!-- Invoice Content -->
        <div class="invoice-content">
            <!-- Header -->
            <div class="invoice-header">
                <div class="row">
                    <div class="col-6">
                        <div class="company-logo-section">
                            <!-- Logo placeholder - you can add your logo here -->
                            <div class="logo-placeholder mb-2" style="width: 60px; height: 60px; background: linear-gradient(45deg, #d4af37, #f4e4a6); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-bottom: 15px;">
                                <span style="color: white; font-size: 24px; font-weight: bold;">BS</span>
                            </div>
                            <h1 class="company-name">Brides of Saima</h1>
                        </div>
                        <div class="company-details">
                            <p class="mb-1"><strong>Premium Bridal Makeup</strong></p>
                            <p class="mb-1">Paschim Midnapore</p>
                            <p class="mb-1">Phone: +91-6290434601</p>
                            <p class="mb-1">Email: sksaima821@gmail.com</p>
                            <p class="mb-0">Website: www.bridesofsaima.com</p>
                        </div>
                    </div>
                    <div class="col-6 text-end">
                        <div class="invoice-number-section">
                            <h2 class="invoice-number">INVOICE</h2>
                            <h3 class="text-primary invoice-number-value">{{ invoice.invoice_number }}</h3>
                        </div>
                        <div class="mt-3">
                            {% if invoice.payment_status == 'paid' %}
                                <span class="badge bg-success fs-6">PAID</span>
                            {% elif invoice.payment_status == 'partially_paid' %}
                                <span class="badge bg-info fs-6">PARTIALLY PAID</span>
                            {% elif invoice.payment_status == 'pending' %}
                                <span class="badge bg-warning text-dark fs-6">PENDING</span>
                            {% elif invoice.payment_status == 'overdue' %}
                                <span class="badge bg-danger fs-6">OVERDUE</span>
                            {% else %}
                                <span class="badge bg-secondary fs-6">{{ invoice.get_payment_status_display|upper }}</span>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bill To and Invoice Details -->
            <div class="row mb-4">
                <div class="col-6">
                    <h5 class="text-primary mb-3">BILL TO:</h5>
                    <div class="border p-3 rounded">
                        <h6 class="mb-2">{{ invoice.customer.name }}</h6>
                        {% if invoice.customer.email %}
                            <p class="mb-1">{{ invoice.customer.email }}</p>
                        {% endif %}
                        {% if invoice.customer.phone %}
                            <p class="mb-1">{{ invoice.customer.phone }}</p>
                        {% endif %}
                        {% if invoice.customer.address %}
                            <div class="mb-0">{{ invoice.customer.address|linebreaks }}</div>
                        {% endif %}
                    </div>
                </div>
                <div class="col-6">
                    <h5 class="text-primary mb-3">INVOICE DETAILS:</h5>
                    <div class="border p-3 rounded bg-light">
                        <table class="table table-borderless mb-0">
                            <tr>
                                <td><strong>Issue Date:</strong></td>
                                <td>{{ invoice.issue_date|date:"F d, Y" }}</td>
                            </tr>
                            <tr>
                                <td><strong>Due Date:</strong></td>
                                <td>{{ invoice.due_date|date:"F d, Y" }}</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Totals and Items Section -->
            <div class="row mb-4">
                <div class="col-6">
                    <h5 class="text-primary mb-3">PAYMENT SUMMARY:</h5>
                    <div class="border p-3 rounded bg-light">
                        <table class="table table-borderless mb-0">
                            <tr>
                                <td><strong>Subtotal:</strong></td>
                                <td class="text-end"><strong>₹{{ invoice.get_subtotal|floatformat:2 }}</strong></td>
                            </tr>
                            {% if invoice.discount_percentage > 0 %}
                            <tr>
                                <td>Discount ({{ invoice.discount_percentage }}%):</td>
                                <td class="text-end text-success">-₹{{ invoice.get_discount_amount|floatformat:2 }}</td>
                            </tr>
                            {% endif %}
                            {% if invoice.tax_percentage > 0 %}
                            <tr>
                                <td>Tax ({{ invoice.tax_percentage }}%):</td>
                                <td class="text-end">₹{{ invoice.get_tax_amount|floatformat:2 }}</td>
                            </tr>
                            {% endif %}
                            <tr class="total-row">
                                <td><strong style="font-size: 1.2em;">TOTAL:</strong></td>
                                <td class="text-end"><strong style="font-size: 1.2em;">₹{{ invoice.get_total|floatformat:2 }}</strong></td>
                            </tr>
                            {% if invoice.advance_amount > 0 %}
                            <tr>
                                <td><strong>Advance Paid:</strong></td>
                                <td class="text-end"><strong>₹{{ invoice.advance_amount|floatformat:2 }}</strong></td>
                            </tr>
                            <tr style="background: linear-gradient(135deg, #2c3e50, #34495e, #1a252f); border: 1px solid #34495e;">
                                <td><strong style="font-size: 1.1em; color: white;">DUE AMOUNT:</strong></td>
                                <td class="text-end"><strong style="font-size: 1.1em; color: white;">₹{{ invoice.get_due_amount|floatformat:2 }}</strong></td>
                            </tr>
                            {% endif %}
                        </table>
                    </div>
                </div>
                <div class="col-6">
                    <h5 class="text-primary mb-3">ITEMS:</h5>
                    <div class="border rounded" style="max-height: 300px; overflow-y: auto;">
                        <table class="table table-bordered mb-0">
                            <thead>
                                <tr style="background-color: #f8f9fa;">
                                    <th width="50%" style="font-size: 0.9em;">Description</th>
                                    <th width="20%" class="text-center" style="font-size: 0.9em;">Qty</th>
                                    <th width="30%" class="text-end" style="font-size: 0.9em;">Amount</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for item in invoice.items.all %}
                                <tr>
                                    <td style="font-size: 0.85em;">{{ item.description }}</td>
                                    <td class="text-center" style="font-size: 0.85em;">{{ item.quantity }}</td>
                                    <td class="text-end" style="font-size: 0.85em;">₹{{ item.get_total|floatformat:2 }}</td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="3" class="text-center text-muted">No items found</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Notes Section (if any) -->
            {% if invoice.notes %}
            <div class="row mb-4">
                <div class="col-12">
                    <h5 class="text-primary mb-3">NOTES:</h5>
                    <div class="border p-3 rounded">
                        {{ invoice.notes|linebreaks }}
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Terms & Conditions -->
            <div class="mt-4 pt-3 border-top terms-conditions">
                <h6 class="text-primary mb-3"><strong>Terms & Conditions</strong></h6>
                <div class="terms-conditions">
                    <ul style="list-style: none; padding-left: 0; margin: 0;">
                        <li style="margin-bottom: 8px; font-size: 0.9em;">• <strong>Advance payment is non-refundable</strong></li>
                        <li style="margin-bottom: 8px; font-size: 0.9em;">• <strong>Please pay at least 50% of the balance 24 hours before the event.</strong></li>
                        <li style="margin-bottom: 8px; font-size: 0.9em;">• <strong>Any change in date is chargeable and depends on availability.</strong></li>
                        <li style="margin-bottom: 0; font-size: 0.9em;">• <strong>We will post images and reels on our social media. Any objections must be notified in advance.</strong></li>
                    </ul>
                </div>
            </div>

            <!-- Footer -->
            <div class="mt-5 pt-4 border-top text-center text-muted">
                <p><strong>Thank You!</strong></p>
                <p class="small">
                    For any questions regarding this invoice, please contact us at sksaima821@gmail.com or +91-6290434601
                </p>
                
                <!-- Follow Us Section -->
                <div class="mt-4 pt-3 text-center">
                    <p class="mb-3"><strong style="font-size: 1.1em; color: #333;">Follow Us on Instagram</strong></p>
                    <img src="/static/BridesOfSaima/images/instaQR.png" 
                         alt="Instagram QR Code" 
                         style="width: 120px; height: 120px; border: 3px solid #d4af37; border-radius: 12px; margin-bottom: 8px; background-color: #f8f9fa;" 
                         onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                    <div style="display: none; width: 120px; height: 120px; border: 3px solid #d4af37; border-radius: 12px; margin: 0 auto 8px; background: linear-gradient(45deg, #d4af37, #f4e4a6); justify-content: center; align-items: center; color: white; font-weight: bold; font-size: 14px;">
                        QR CODE
                    </div>
                    <p style="font-size: 1em; font-weight: 600; color: #d4af37; margin: 0;">@bridesofsaima</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Auto-focus on print dialog when page loads
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 500);
        };
    </script>
</body>
</html>